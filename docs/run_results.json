{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.3", "generated_at": "2023-12-12T20:23:25.532509Z", "invocation_id": "96baf5c3-fc09-4f17-a3b5-609e6dcdd8eb", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.338150Z", "completed_at": "2023-12-12T20:23:24.363178Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.370542Z", "completed_at": "2023-12-12T20:23:24.370555Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035588979721069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_ad_group_history_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.360165Z", "completed_at": "2023-12-12T20:23:24.370005Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.372693Z", "completed_at": "2023-12-12T20:23:24.372700Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036400794982910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_ad_group_report_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.363550Z", "completed_at": "2023-12-12T20:23:24.370277Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.373036Z", "completed_at": "2023-12-12T20:23:24.373039Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016582012176513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_advertiser_history_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.366428Z", "completed_at": "2023-12-12T20:23:24.370846Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.373678Z", "completed_at": "2023-12-12T20:23:24.373681Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016896963119506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_advertiser_report_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.377777Z", "completed_at": "2023-12-12T20:23:24.389152Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.392962Z", "completed_at": "2023-12-12T20:23:24.392969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018977880477905273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_campaign_history_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.385468Z", "completed_at": "2023-12-12T20:23:24.392655Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.394796Z", "completed_at": "2023-12-12T20:23:24.394799Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018738269805908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_keyword_history_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.382041Z", "completed_at": "2023-12-12T20:23:24.393233Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.395699Z", "completed_at": "2023-12-12T20:23:24.395702Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020496845245361328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_campaign_report_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.389422Z", "completed_at": "2023-12-12T20:23:24.394266Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.397022Z", "completed_at": "2023-12-12T20:23:24.397027Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01782512664794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_keyword_report_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.399649Z", "completed_at": "2023-12-12T20:23:24.407204Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.412170Z", "completed_at": "2023-12-12T20:23:24.412179Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017290830612182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_pin_promotion_history_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.407458Z", "completed_at": "2023-12-12T20:23:24.409128Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.412916Z", "completed_at": "2023-12-12T20:23:24.412923Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011999845504760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.409481Z", "completed_at": "2023-12-12T20:23:24.410377Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.413240Z", "completed_at": "2023-12-12T20:23:24.413243Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011867046356201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_ad_group_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.404217Z", "completed_at": "2023-12-12T20:23:24.411084Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.414283Z", "completed_at": "2023-12-12T20:23:24.414291Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017105817794799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"pinterest_source_integration_tests_3\".\"pinterest_pin_promotion_report_data\"", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.419874Z", "completed_at": "2023-12-12T20:23:24.421025Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.426511Z", "completed_at": "2023-12-12T20:23:24.426519Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010636091232299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_advertiser_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.421551Z", "completed_at": "2023-12-12T20:23:24.422519Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.427065Z", "completed_at": "2023-12-12T20:23:24.427068Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010661125183105469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_advertiser_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.422836Z", "completed_at": "2023-12-12T20:23:24.423770Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.427363Z", "completed_at": "2023-12-12T20:23:24.427369Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01076507568359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.424424Z", "completed_at": "2023-12-12T20:23:24.425467Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.428235Z", "completed_at": "2023-12-12T20:23:24.428237Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011054754257202148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_campaign_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.433803Z", "completed_at": "2023-12-12T20:23:24.435584Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.440527Z", "completed_at": "2023-12-12T20:23:24.440533Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010608196258544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_keyword_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.436123Z", "completed_at": "2023-12-12T20:23:24.437026Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.441038Z", "completed_at": "2023-12-12T20:23:24.441041Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010789871215820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_keyword_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.437302Z", "completed_at": "2023-12-12T20:23:24.438205Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.441304Z", "completed_at": "2023-12-12T20:23:24.441308Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010958194732666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_pin_promotion_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.438748Z", "completed_at": "2023-12-12T20:23:24.439631Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.442124Z", "completed_at": "2023-12-12T20:23:24.442128Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011312246322631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_pin_promotion_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.459106Z", "completed_at": "2023-12-12T20:23:24.820056Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.822098Z", "completed_at": "2023-12-12T20:23:24.822101Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.40360307693481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    currency\n    \n as \n    \n    currency\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    owner_user_id\n    \n as \n    \n    owner_user_id\n    \n, \n    \n    \n    owner_username\n    \n as \n    \n    owner_username\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n        \n            \n            \"permissions\"\n            \n        \n    \n as advertiser_permissions , \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as advertiser_id,\n        name as advertiser_name,\n        country,\n        created_time as created_at,\n        currency as currency_code,\n        owner_user_id,\n        owner_username,\n        advertiser_permissions, -- permissions was renamed in macro\n        updated_time as updated_at,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.455068Z", "completed_at": "2023-12-12T20:23:24.819008Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.820835Z", "completed_at": "2023-12-12T20:23:24.820843Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.40459489822387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_group_name\n    \n as \n    \n    ad_group_name\n    \n, \n    \n    \n    ad_group_status\n    \n as \n    \n    ad_group_status\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    cast(null as integer) as \n    \n    clickthrough_2\n    \n , \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    cast(null as integer) as \n    \n    impression_2\n    \n , \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date_trunc('day', date) as date_day,\n        ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        campaign_id,\n        advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.463138Z", "completed_at": "2023-12-12T20:23:24.819406Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.821355Z", "completed_at": "2023-12-12T20:23:24.821358Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.40398502349853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    cast(null as integer) as \n    \n    clickthrough_2\n    \n , \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    cast(null as integer) as \n    \n    impression_2\n    \n , \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date_trunc('day', date) as date_day,\n        advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.447882Z", "completed_at": "2023-12-12T20:23:24.820551Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:24.822605Z", "completed_at": "2023-12-12T20:23:24.822608Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4234578609466553, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_history_tmp\"\n), \n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    end_time\n    \n as \n    \n    end_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ad_account_id\n    \n as \n    \n    ad_account_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    pacing_delivery_type\n    \n as \n    \n    pacing_delivery_type\n    \n, \n    \n    \n    placement_group\n    \n as \n    \n    placement_group\n    \n, \n    \n    \n    start_time\n    \n as \n    \n    start_time\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    summary_status\n    \n as \n    \n    summary_status\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        id as ad_group_id,\n        name as ad_group_name,\n        status as ad_group_status,\n        ad_account_id as advertiser_id,\n        _fivetran_synced,\n        campaign_id,\n        created_time as created_at,\n        end_time,\n        pacing_delivery_type,\n        placement_group,\n        start_time,\n        summary_status,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.864027Z", "completed_at": "2023-12-12T20:23:25.130327Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.130937Z", "completed_at": "2023-12-12T20:23:25.130945Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3056950569152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_name\n    \n as \n    \n    campaign_name\n    \n, \n    \n    \n    campaign_status\n    \n as \n    \n    campaign_status\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    cast(null as integer) as \n    \n    clickthrough_2\n    \n , \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    cast(null as integer) as \n    \n    impression_2\n    \n , \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date_trunc('day', date) as date_day,\n        campaign_id,\n        campaign_name,\n        campaign_status,\n        advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.871091Z", "completed_at": "2023-12-12T20:23:25.158528Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.160625Z", "completed_at": "2023-12-12T20:23:25.160629Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.31990599632263184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_group_name\n    \n as \n    \n    ad_group_name\n    \n, \n    \n    \n    ad_group_status\n    \n as \n    \n    ad_group_status\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    cast(null as integer) as \n    \n    clickthrough_2\n    \n , \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    cast(null as integer) as \n    \n    impression_2\n    \n , \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    pin_promotion_id\n    \n as \n    \n    pin_promotion_id\n    \n, \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        date_trunc('day', date) as date_day,\n        keyword_id,\n        pin_promotion_id,\n        ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        campaign_id,\n        advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.854755Z", "completed_at": "2023-12-12T20:23:25.158871Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.160915Z", "completed_at": "2023-12-12T20:23:25.160919Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3381178379058838, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_history_tmp\"\n), \n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    default_ad_group_budget_in_micro_currency\n    \n as \n    \n    default_ad_group_budget_in_micro_currency\n    \n, \n    \n    \n    is_automated_campaign\n    \n as \n    \n    is_automated_campaign\n    \n, \n    \n    \n    is_campaign_budget_optimization\n    \n as \n    \n    is_campaign_budget_optimization\n    \n, \n    \n    \n    is_flexible_daily_budgets\n    \n as \n    \n    is_flexible_daily_budgets\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation, \n        id as campaign_id,\n        name as campaign_name,\n        advertiser_id,\n        default_ad_group_budget_in_micro_currency,\n        is_automated_campaign,\n        is_campaign_budget_optimization,\n        is_flexible_daily_budgets,\n        status as campaign_status,\n        _fivetran_synced,\n        created_time as created_at,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.197713Z", "completed_at": "2023-12-12T20:23:25.206542Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.207147Z", "completed_at": "2023-12-12T20:23:25.207155Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01532435417175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__advertiser_history_source_relation__updated_at__advertiser_id.8308a26e9f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, updated_at, advertiser_id\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_history\"\n    group by source_relation, updated_at, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.208903Z", "completed_at": "2023-12-12T20:23:25.221572Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.222122Z", "completed_at": "2023-12-12T20:23:25.222129Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014287233352661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_history_advertiser_id.7d24f665fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect advertiser_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_history\"\nwhere advertiser_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.224666Z", "completed_at": "2023-12-12T20:23:25.229097Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.229685Z", "completed_at": "2023-12-12T20:23:25.229692Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006659984588623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__ad_group_report_source_relation__date_day__ad_group_id__campaign_id__advertiser_id.83246fd43c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, ad_group_id, campaign_id, advertiser_id\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_report\"\n    group by source_relation, date_day, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.231369Z", "completed_at": "2023-12-12T20:23:25.234679Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.235214Z", "completed_at": "2023-12-12T20:23:25.235220Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004907131195068359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_report_ad_group_id.bb8cf3c471", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_report\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.237111Z", "completed_at": "2023-12-12T20:23:25.240318Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.240859Z", "completed_at": "2023-12-12T20:23:25.240865Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004956960678100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_report_date_day.80e8904c4c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.242810Z", "completed_at": "2023-12-12T20:23:25.246168Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.246705Z", "completed_at": "2023-12-12T20:23:25.246714Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005072832107543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__advertiser_report_source_relation__date_day__advertiser_id.cadbd5fae2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, advertiser_id\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_report\"\n    group by source_relation, date_day, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.248386Z", "completed_at": "2023-12-12T20:23:25.252458Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.252953Z", "completed_at": "2023-12-12T20:23:25.252960Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00557398796081543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_report_advertiser_id.1b16ed73ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect advertiser_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_report\"\nwhere advertiser_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:24.860088Z", "completed_at": "2023-12-12T20:23:25.223216Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.224357Z", "completed_at": "2023-12-12T20:23:25.224363Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4053182601928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    bid\n    \n as \n    \n    bid\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    match_type\n    \n as \n    \n    match_type\n    \n, \n    \n    \n    parent_type\n    \n as \n    \n    parent_type\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        id as keyword_id,\n        value as keyword_value,\n        _fivetran_id,\n        _fivetran_synced,\n        ad_group_id,\n        advertiser_id,\n        archived,\n        bid,\n        campaign_id,\n        match_type,\n        parent_type,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.255039Z", "completed_at": "2023-12-12T20:23:25.263711Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.264362Z", "completed_at": "2023-12-12T20:23:25.264368Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010828018188476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_report_date_day.153bd03c95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__advertiser_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.260319Z", "completed_at": "2023-12-12T20:23:25.265466Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.266775Z", "completed_at": "2023-12-12T20:23:25.266784Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011101007461547852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__ad_group_history_source_relation__ad_group_id___fivetran_synced.ef2b22b2ca", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, _fivetran_synced\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_history\"\n    group by source_relation, ad_group_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.267182Z", "completed_at": "2023-12-12T20:23:25.272110Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.276226Z", "completed_at": "2023-12-12T20:23:25.276233Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011030912399291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_history_ad_group_id.220c6220be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__ad_group_history\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.272409Z", "completed_at": "2023-12-12T20:23:25.277452Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.278618Z", "completed_at": "2023-12-12T20:23:25.278622Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011518001556396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__campaign_report_source_relation__date_day__campaign_id__advertiser_id.6dd9b7bce6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, campaign_id, advertiser_id\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_report\"\n    group by source_relation, date_day, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.278885Z", "completed_at": "2023-12-12T20:23:25.284765Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.288338Z", "completed_at": "2023-12-12T20:23:25.288344Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011080026626586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_report_campaign_id.a287eba0fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.285075Z", "completed_at": "2023-12-12T20:23:25.289487Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.290872Z", "completed_at": "2023-12-12T20:23:25.290878Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011160612106323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_report_date_day.7ef5fb1238", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.291183Z", "completed_at": "2023-12-12T20:23:25.296546Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.300590Z", "completed_at": "2023-12-12T20:23:25.300600Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011379003524780273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__keyword_report_source_relation__date_day__keyword_id__pin_promotion_id__ad_group_id__campaign_id__advertiser_id.f43dda0239", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, keyword_id, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_report\"\n    group by source_relation, date_day, keyword_id, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.296858Z", "completed_at": "2023-12-12T20:23:25.301900Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.303144Z", "completed_at": "2023-12-12T20:23:25.303149Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010436058044433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_report_date_day.9937216300", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.303444Z", "completed_at": "2023-12-12T20:23:25.308032Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.311827Z", "completed_at": "2023-12-12T20:23:25.311834Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010165691375732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_report_keyword_id.5f00679c48", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_report\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.308428Z", "completed_at": "2023-12-12T20:23:25.313172Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.314433Z", "completed_at": "2023-12-12T20:23:25.314437Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01161503791809082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__campaign_history_source_relation__campaign_id___fivetran_synced.84df0386bc", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, _fivetran_synced\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_history\"\n    group by source_relation, campaign_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.314725Z", "completed_at": "2023-12-12T20:23:25.320320Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.323926Z", "completed_at": "2023-12-12T20:23:25.323932Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010946989059448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_history_campaign_id.60cb10d341", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.320594Z", "completed_at": "2023-12-12T20:23:25.325583Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.329200Z", "completed_at": "2023-12-12T20:23:25.329205Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009994983673095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__keyword_history_source_relation__keyword_id__ad_group_id___fivetran_synced.2cd3b85ca9", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, ad_group_id, _fivetran_synced\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_history\"\n    group by source_relation, keyword_id, ad_group_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.326364Z", "completed_at": "2023-12-12T20:23:25.330144Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.330623Z", "completed_at": "2023-12-12T20:23:25.330627Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005865812301635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_history_keyword_id.246889377a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__keyword_history\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.162396Z", "completed_at": "2023-12-12T20:23:25.472900Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.474003Z", "completed_at": "2023-12-12T20:23:25.474011Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3404688835144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_history_tmp\"\n), \n\nfields as (\n\n    select\n\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_account_id\n    \n as \n    \n    ad_account_id\n    \n, \n    cast(null as TEXT) as \n    \n    android_deep_link\n    \n , \n    cast(null as TEXT) as \n    \n    click_tracking_url\n    \n , \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    creative_type\n    \n as \n    \n    creative_type\n    \n, \n    \n    \n    destination_url\n    \n as \n    \n    destination_url\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as TEXT) as \n    \n    ios_deep_link\n    \n , \n    cast(null as boolean) as \n    \n    is_pin_deleted\n    \n , \n    cast(null as boolean) as \n    \n    is_removable\n    \n , \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    pin_id\n    \n as \n    \n    pin_id\n    \n, \n    cast(null as TEXT) as \n    \n    review_status\n    \n , \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    cast(null as timestamp) as \n    \n    updated_time\n    \n , \n    cast(null as TEXT) as \n    \n    view_tracking_url\n    \n \n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation,\n        id as pin_promotion_id,\n        ad_account_id as advertiser_id,\n        ad_group_id,\n        created_time as created_at,\n        destination_url,\n        \n\n  \n    \n\n    split_part(\n        destination_url,\n        '?',\n        1\n        )\n\n\n  \n\n as base_url,\n        \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/',\n        1\n        )\n\n\n  \n\n,\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_host,\n        '/' || \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n    right(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    position(\n        '/' in \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ), 0),\n            \n\n    position(\n        '?' in \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ) - 1\n            )\n    ),\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_path,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        destination_url,\n        'utm_source=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        destination_url,\n        'utm_medium=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        destination_url,\n        'utm_campaign=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        destination_url,\n        'utm_content=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_content,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        destination_url,\n        'utm_term=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_term,\n        name as pin_name,\n        pin_id,\n        status as pin_status,\n        creative_type,\n        _fivetran_synced,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.193211Z", "completed_at": "2023-12-12T20:23:25.473229Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.474282Z", "completed_at": "2023-12-12T20:23:25.474286Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.31032228469848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_report_tmp\"\n), \n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    \n    \n    clickthrough_2\n    \n as \n    \n    clickthrough_2\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    \n    \n    impression_2\n    \n as \n    \n    impression_2\n    \n, \n    \n    \n    pin_promotion_id\n    \n as \n    \n    pin_promotion_id\n    \n, \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation, \n        date_trunc('day', date) as date_day,\n        pin_promotion_id,\n        ad_group_id,\n        campaign_id,\n        advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.505968Z", "completed_at": "2023-12-12T20:23:25.518818Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.519636Z", "completed_at": "2023-12-12T20:23:25.519643Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01737689971923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__pin_promotion_history_source_relation___fivetran_synced__pin_promotion_id.8064d48c11", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, _fivetran_synced, pin_promotion_id\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_history\"\n    group by source_relation, _fivetran_synced, pin_promotion_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.509982Z", "completed_at": "2023-12-12T20:23:25.519936Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.522274Z", "completed_at": "2023-12-12T20:23:25.522277Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01928400993347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_history_pin_promotion_id.171995cd34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pin_promotion_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_history\"\nwhere pin_promotion_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.515707Z", "completed_at": "2023-12-12T20:23:25.520205Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.522540Z", "completed_at": "2023-12-12T20:23:25.522544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0188448429107666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_report_date_day.ed272212a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.512867Z", "completed_at": "2023-12-12T20:23:25.520436Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.522815Z", "completed_at": "2023-12-12T20:23:25.522820Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01970982551574707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__pin_promotion_report_source_relation__date_day__pin_promotion_id__ad_group_id__campaign_id__advertiser_id.8b358e3946", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    from \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_report\"\n    group by source_relation, date_day, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:23:25.525659Z", "completed_at": "2023-12-12T20:23:25.529749Z"}, {"name": "execute", "started_at": "2023-12-12T20:23:25.530275Z", "completed_at": "2023-12-12T20:23:25.530281Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007565021514892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_report_pin_promotion_id.9c3c9f71ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pin_promotion_id\nfrom \"postgres\".\"pinterest_source_integration_tests_3_pinterest_source\".\"stg_pinterest_ads__pin_promotion_report\"\nwhere pin_promotion_id is null\n\n\n", "relation_name": null}], "elapsed_time": 2.298818826675415, "args": {"enable_legacy_logger": false, "print": true, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "empty_catalog": false, "partial_parse_file_diff": true, "strict_mode": false, "log_format": "default", "log_path": "/Users/joseph.markiewicz/Documents/dbt_packages/ad_reporting/pinterest/dbt_pinterest_source/integration_tests/logs", "target": "postgres", "favor_state": false, "cache_selected_only": false, "macro_debugging": false, "vars": {}, "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "introspect": true, "show_resource_report": false, "static": false, "write_json": true, "quiet": false, "compile": true, "printer_width": 80, "static_parser": true, "use_colors_file": true, "log_file_max_bytes": 10485760, "defer": false, "populate_cache": true, "invocation_command": "dbt docs generate -t postgres", "project_dir": "/Users/joseph.markiewicz/Documents/dbt_packages/ad_reporting/pinterest/dbt_pinterest_source/integration_tests", "exclude": [], "use_colors": true, "partial_parse": true, "select": [], "profiles_dir": "/Users/joseph.markiewicz/.dbt", "which": "generate", "log_format_file": "debug", "version_check": true}}